Based on Windows Azure storage replication paper